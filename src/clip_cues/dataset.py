"""Dataset Loading for Synthetic Image Detection.

This module provides utilities for loading datasets from HuggingFace Hub.
"""

from datasets import load_dataset, DatasetDict


def load_synthclic(cache_dir: str = None) -> DatasetDict:
    """Load SynthCLIC dataset from HuggingFace Hub.

    SynthCLIC contains real images from the CLIC compression challenge
    and synthetic images generated by various models.

    Args:
        cache_dir: Directory to cache downloaded data

    Returns:
        DatasetDict with train, validation, and test splits

    Example:
        >>> dataset = load_synthclic()
        >>> train = dataset["train"]
        >>> print(f"Training samples: {len(train)}")
    """
    return load_dataset("marco-willi/synthclic", cache_dir=cache_dir)


def load_synthbuster_plus(cache_dir: str = None) -> DatasetDict:
    """Load SynthbusterPlus dataset from HuggingFace Hub.

    SynthbusterPlus contains real images and synthetic images from
    multiple generative models.

    Args:
        cache_dir: Directory to cache downloaded data

    Returns:
        DatasetDict with train, validation, and test splits

    Example:
        >>> dataset = load_synthbuster_plus()
        >>> test = dataset["test"]
        >>> print(f"Test samples: {len(test)}")
    """
    return load_dataset("marco-willi/synthbuster-plus", cache_dir=cache_dir)


def get_dataset(name: str, cache_dir: str = None) -> DatasetDict:
    """Load a dataset by name.

    Args:
        name: Dataset name ("synthclic" or "synthbuster_plus")
        cache_dir: Directory to cache downloaded data

    Returns:
        DatasetDict with train, validation, and test splits

    Raises:
        ValueError: If dataset name is not recognized
    """
    datasets = {
        "synthclic": load_synthclic,
        "synthbuster_plus": load_synthbuster_plus,
    }

    if name not in datasets:
        raise ValueError(f"Unknown dataset: {name}. Available: {list(datasets.keys())}")

    return datasets[name](cache_dir=cache_dir)
